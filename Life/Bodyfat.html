<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Body Fat Calculator – Professional & Accurate</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
:root{
  --primary:#2563eb;
  --bg:#f4f7fb;
  --card:#ffffff;
  --radius:16px;
  --text:#1f2937;
  --muted:#6b7280;
}
*{box-sizing:border-box}
body{
  margin:0;
  font-family:Inter,system-ui,Arial;
  background:var(--bg);
  color:var(--text);
}
.container{max-width:1200px;margin:auto;padding:20px}
.card{
  background:var(--card);
  border-radius:var(--radius);
  padding:28px;
  box-shadow:0 14px 36px rgba(0,0,0,.08);
}
h1{margin:0;color:var(--primary)}
small{color:var(--muted)}

.grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(260px,1fr));
  gap:20px;
}
input,select{
  width:100%;
  padding:14px;
  font-size:16px;
  border-radius:10px;
  border:1px solid #ddd;
}
button{
  width:100%;
  padding:18px;
  background:var(--primary);
  color:#fff;
  border:none;
  border-radius:14px;
  font-size:18px;
  cursor:pointer;
}
.error{color:#dc2626;font-weight:600;margin-top:10px}

table{width:100%;border-collapse:collapse}
td{padding:8px 6px;border-bottom:1px solid #eee}

/* ===== PERFECT CHART ===== */
.chart-box{max-width:360px;margin:auto}
.chart-wrap{
  position:relative;
  width:100%;
  aspect-ratio:1/1;
}
.chart-wrap canvas{
  width:100%!important;
  height:100%!important;
}
.chart-center{
  position:absolute;
  inset:0;
  display:flex;
  align-items:center;
  justify-content:center;
  flex-direction:column;
  text-align:center;
  pointer-events:none;
}
.chart-center b{font-size:26px}
.chart-center span{font-size:14px;color:var(--muted)}

.insight{
  margin-top:18px;
  padding:16px;
  border-radius:12px;
  background:#f1f5f9;
  font-size:14px;
  line-height:1.6;
}
.insight strong{color:#111}
</style>
</head>

<body>
<div class="container">

<div class="card">
<h1>Body Fat Calculator</h1>
<small>U.S. Navy Method · Medical-grade accuracy · Metric & US units</small>
<br><br>

<div class="grid">
  <select id="unit">
    <option value="metric">Metric (cm / kg)</option>
    <option value="us">US Units (in / lb)</option>
  </select>

  <select id="gender">
    <option value="">Gender</option>
    <option value="male">Male</option>
    <option value="female">Female</option>
  </select>

  <input id="age" type="number" placeholder="Age (18+)">
  <input id="height" type="number" placeholder="Height (cm / in)">
  <input id="weight" type="number" placeholder="Weight (kg / lb)">
  <input id="neck" type="number" placeholder="Neck circumference">
  <input id="waist" type="number" placeholder="Waist circumference">
  <input id="hip" type="number" placeholder="Hip (female only)">
</div>

<br>
<button onclick="calculate()">Calculate</button>
<div id="error" class="error"></div>
</div>

<br>

<div class="grid">
  <div class="card">
    <div id="output">Result = —</div>
    <div id="insight" class="insight"></div>
  </div>

  <div class="card">
    <div class="chart-box">
      <div class="chart-wrap">
        <canvas id="chart"></canvas>
        <div class="chart-center" id="centerText"></div>
      </div>
    </div>
  </div>
</div>

</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
let chart;

gender.addEventListener("change",()=>{
  hip.disabled = gender.value==="male";
  if(gender.value==="male") hip.value="";
});

function calculate(){
  error.innerText="";
  if(chart) chart.destroy();

  let unitVal=unit.value, g=gender.value;
  let agev=+age.value, h=+height.value, w=+weight.value;
  let n=+neck.value, wa=+waist.value, hi=+hip.value;

  if(!g||!agev||!h||!w||!n||!wa){
    error.innerText="Please fill all required fields.";
    return;
  }
  if(agev<18){
    error.innerText="This calculator is intended for adults (18+).";
    return;
  }

  if(unitVal==="us"){
    h*=2.54; w*=0.453592; n*=2.54; wa*=2.54; hi*=2.54;
  }

  if(g==="male" && wa<=n){
    error.innerText="Waist must be greater than neck.";
    return;
  }
  if(g==="female" && (!hi || wa+hi<=n)){
    error.innerText="Waist + hip must be greater than neck.";
    return;
  }

  let bf = g==="male"
    ?86.01*Math.log10(wa-n)-70.041*Math.log10(h)+36.76
    :163.205*Math.log10(wa+hi-n)-97.684*Math.log10(h)-78.387;

  bf=Math.min(Math.max(bf,2),60);

  let fat=w*(bf/100), lean=w-fat;

  let category =
    bf<6?"Very lean":
    bf<14?"Athletic range":
    bf<18?"Fitness range":
    bf<25?"Average range":
    "Above recommended range";

  let ideal = g==="male"
    ?Math.max(8,18-(agev-20)*0.2)
    :Math.max(18,25-(agev-20)*0.2);

  let lose=Math.max(0,w*(bf-ideal)/100);

  let bmi=w/((h/100)**2);
  let bmiBF=(g==="male"
    ?1.2*bmi+0.23*agev-16.2
    :1.2*bmi+0.23*agev-5.4);
  bmiBF=Math.min(Math.max(bmiBF,8),40);

  output.innerHTML=`
  <table>
    <tr><td><b>Body Fat</b></td><td>${bf.toFixed(1)}%</td></tr>
    <tr><td>Category</td><td>${category}</td></tr>
    <tr><td>Fat Mass</td><td>${fat.toFixed(1)} kg</td></tr>
    <tr><td>Lean Mass</td><td>${lean.toFixed(1)} kg</td></tr>
    <tr><td>Ideal Body Fat</td><td>${ideal.toFixed(1)}%</td></tr>
    <tr><td>Estimated Fat to Lose</td><td>${lose.toFixed(1)} kg</td></tr>
    <tr><td>BMI-based estimate</td><td>${bmiBF.toFixed(1)}%</td></tr>
  </table>`;

  centerText.innerHTML=`<b>${bf.toFixed(1)}%</b><span>${category}</span>`;

  insight.innerHTML=`
    <strong>How to understand this:</strong><br>
    This estimate uses the U.S. Navy body fat method, commonly used for fitness and health screening.
    <br><br>
    <strong>Note:</strong> Fat-loss estimates assume lean mass is preserved. Actual results depend on diet, training, and health factors.
    ${bf<5?'<br><br><strong>Important:</strong> Values below 5% are extremely lean and uncommon in the general population.':''}
  `;

  chart=new Chart(chartEl,{
    type:"doughnut",
    data:{
      labels:["Fat Mass","Lean Mass"],
      datasets:[{
        data:[fat,lean],
        backgroundColor:["#f87171","#4ade80"]
      }]
    },
    options:{
      responsive:true,
      maintainAspectRatio:false,
      cutout:"72%",
      plugins:{legend:{position:"bottom"}}
    }
  });
}

const chartEl=document.getElementById("chart");
</script>
</body>
</html>
