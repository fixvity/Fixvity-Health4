<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Body Fat Calculator – Professional</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
:root{
  --primary:#2563eb;
  --bg:#f4f7fb;
  --card:#ffffff;
  --radius:16px;
  --text:#1f2937;
}
*{box-sizing:border-box}
body{
  margin:0;
  font-family:Inter,system-ui,Arial;
  background:var(--bg);
  color:var(--text);
}
.container{
  max-width:1200px;
  margin:auto;
  padding:20px;
}
.card{
  background:var(--card);
  border-radius:var(--radius);
  padding:30px;
  box-shadow:0 14px 36px rgba(0,0,0,.08);
}
h1{margin:0;color:var(--primary)}
small{color:#555}

.grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(260px,1fr));
  gap:20px;
}

input,select{
  width:100%;
  padding:14px;
  font-size:16px;
  border-radius:10px;
  border:1px solid #ddd;
}

button{
  width:100%;
  padding:18px;
  background:var(--primary);
  color:#fff;
  border:none;
  border-radius:14px;
  font-size:18px;
  cursor:pointer;
}
button:hover{opacity:.95}

.error{
  color:#dc2626;
  font-weight:600;
  margin-top:10px;
}

table{
  width:100%;
  border-collapse:collapse;
}
td{
  padding:9px 6px;
  border-bottom:1px solid #eee;
}

/* ===== CHART ===== */
.chart-wrap{
  position:relative;
  height:340px;
}
.chart-center{
  position:absolute;
  top:45%;
  left:50%;
  transform:translate(-50%,-50%);
  text-align:center;
}
.chart-center b{
  font-size:26px;
  display:block;
}
.chart-center span{
  color:#555;
  font-size:14px;
}

/* ===== BODY FAT RANGE BAR ===== */
.range-wrap{
  margin-top:20px;
}
.range-bar{
  position:relative;
  height:14px;
  border-radius:8px;
  overflow:hidden;
  display:flex;
}
.range-bar div{height:100%}
.r1{background:#7c2d12;width:6%}
.r2{background:#facc15;width:8%}
.r3{background:#22c55e;width:10%}
.r4{background:#fde047;width:7%}
.r5{background:#dc2626;width:69%}

.range-pointer{
  position:absolute;
  top:-6px;
  width:0;
  height:0;
  border-left:6px solid transparent;
  border-right:6px solid transparent;
  border-top:10px solid #000;
}

.range-labels{
  display:flex;
  justify-content:space-between;
  font-size:12px;
  margin-top:6px;
  color:#555;
}
</style>
</head>

<body>
<div class="container">

<div class="card">
<h1>Body Fat Calculator</h1>
<small>U.S. Navy Method · Medical-grade accuracy · US & Metric units</small>
<br><br>

<div class="grid">
  <select id="unit">
    <option value="metric">Metric (cm / kg)</option>
    <option value="us">US Units (in / lb)</option>
  </select>

  <select id="gender">
    <option value="">Gender</option>
    <option value="male">Male</option>
    <option value="female">Female</option>
  </select>

  <input id="age" type="number" placeholder="Age (years)">
  <input id="height" type="number" placeholder="Height">
  <input id="weight" type="number" placeholder="Weight">
  <input id="neck" type="number" placeholder="Neck circumference">
  <input id="waist" type="number" placeholder="Waist circumference">
  <input id="hip" type="number" placeholder="Hip (female only)">
</div>

<br>
<button onclick="calculateBodyFat()">Calculate</button>
<div id="error" class="error"></div>
</div>

<br>

<div class="grid">
  <div class="card"><div id="output">Result = —</div></div>

  <div class="card">
    <div class="chart-wrap">
      <canvas id="chart"></canvas>
      <div class="chart-center" id="centerText"></div>
    </div>

    <!-- BODY FAT RANGE BAR -->
    <div class="range-wrap">
      <div class="range-bar">
        <div class="r1"></div>
        <div class="r2"></div>
        <div class="r3"></div>
        <div class="r4"></div>
        <div class="r5"></div>
        <div class="range-pointer" id="bfPointer"></div>
      </div>
      <div class="range-labels">
        <span>Essential</span>
        <span>Athletes</span>
        <span>Fitness</span>
        <span>Average</span>
        <span>Obese</span>
      </div>
    </div>
  </div>
</div>

</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
let chart;

function calculateBodyFat(){
  error.innerText="";
  output.innerHTML="Result = —";
  centerText.innerHTML="";
  if(chart) chart.destroy();

  const unit=unitEl.value, gender=genderEl.value;
  let age=+ageEl.value, h=+heightEl.value, w=+weightEl.value;
  let n=+neckEl.value, wa=+waistEl.value, hi=+hipEl.value;

  if(!gender||!age||!h||!w||!n||!wa){
    error.innerText="Please fill all required fields.";
    return;
  }

  if(unit==="us"){
    h*=2.54; w*=0.453592; n*=2.54; wa*=2.54; hi*=2.54;
  }

  if(gender==="male" && wa<=n){
    error.innerText="For males, waist circumference must be greater than neck.";
    return;
  }

  if(gender==="female"){
    if(!hi){
      error.innerText="Hip measurement is required for females.";
      return;
    }
    if(wa+hi<=n){
      error.innerText="For females, waist + hip must be greater than neck.";
      return;
    }
  }

  let bf = gender==="male"
    ? 86.01*Math.log10(wa-n)-70.041*Math.log10(h)+36.76
    : 163.205*Math.log10(wa+hi-n)-97.684*Math.log10(h)-78.387;

  bf=Math.min(Math.max(bf,2),60);

  const fat=w*(bf/100), lean=w-fat;
  const category=bf<6?"Essential":bf<14?"Athletes":bf<18?"Fitness":bf<25?"Average":"Obese";
  const ideal=Math.max(8,18-(age-20)*0.2);
  const lose=Math.max(0,w*(bf-ideal)/100);
  const bmi=w/((h/100)**2);
  const bmiBF=gender==="male"?1.2*bmi+0.23*age-16.2:1.2*bmi+0.23*age-5.4;

  output.innerHTML=`
  <table>
    <tr><td><b>Body Fat</b></td><td>${bf.toFixed(1)}%</td></tr>
    <tr><td>Category</td><td>${category}</td></tr>
    <tr><td>Fat Mass</td><td>${fat.toFixed(1)} kg</td></tr>
    <tr><td>Lean Mass</td><td>${lean.toFixed(1)} kg</td></tr>
    <tr><td>Ideal Body Fat</td><td>${ideal.toFixed(1)}%</td></tr>
    <tr><td>Fat to Lose</td><td>${lose.toFixed(1)} kg</td></tr>
    <tr><td>BMI Method (ref)</td><td>${bmiBF.toFixed(1)}%</td></tr>
  </table>`;

  centerText.innerHTML=`<b>${bf.toFixed(1)}%</b><span>${category}</span>`;

  /* Move pointer */
  bfPointer.style.left = Math.min(bf,60) + "%";

  chart=new Chart(chartCtx,{
    type:"doughnut",
    data:{
      labels:["Fat Mass","Lean Mass"],
      datasets:[{
        data:[fat,lean],
        backgroundColor:["#f87171","#4ade80"]
      }]
    },
    options:{cutout:"70%",plugins:{legend:{position:"bottom"}}}
  });
}

const unitEl=unit, genderEl=gender, ageEl=age,
heightEl=height, weightEl=weight, neckEl=neck,
waistEl=waist, hipEl=hip,
output=document.getElementById("output"),
centerText=document.getElementById("centerText"),
error=document.getElementById("error"),
bfPointer=document.getElementById("bfPointer"),
chartCtx=document.getElementById("chart").getContext("2d");
</script>

</body>
</html>
