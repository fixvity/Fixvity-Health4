<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Body Fat Calculator – Professional</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
:root{
  --primary:#2563eb;
  --bg:#f4f7fb;
  --card:#ffffff;
  --radius:16px;
  --text:#1f2937;
}
*{box-sizing:border-box}
body{
  margin:0;
  font-family:Inter,system-ui,Arial;
  background:var(--bg);
  color:var(--text);
}
.container{max-width:1200px;margin:auto;padding:20px}
.card{
  background:var(--card);
  border-radius:var(--radius);
  padding:30px;
  box-shadow:0 14px 36px rgba(0,0,0,.08);
}
h1{margin:0;color:var(--primary)}
small{color:#555}
.grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(260px,1fr));
  gap:20px;
}
input,select{
  width:100%;
  padding:14px;
  font-size:16px;
  border-radius:10px;
  border:1px solid #ddd;
}
button{
  width:100%;
  padding:18px;
  background:var(--primary);
  color:#fff;
  border:none;
  border-radius:14px;
  font-size:18px;
  cursor:pointer;
}
.error{color:#dc2626;font-weight:600;margin-top:10px}
table{width:100%;border-collapse:collapse}
td{padding:9px 6px;border-bottom:1px solid #eee}

/* ===== CHART ===== */
.chart-wrap{position:relative;height:340px}
.chart-center{
  position:absolute;
  top:45%;left:50%;
  transform:translate(-50%,-50%);
  text-align:center;
}
.chart-center b{font-size:26px;display:block}
.chart-center span{font-size:14px;color:#555}

/* ===== RANGE BAR ===== */
.range-wrap{margin-top:20px}
.range-bar{
  position:relative;
  height:14px;
  border-radius:8px;
  overflow:hidden;
  display:flex;
}
.range-bar div{height:100%}
.r1{background:#7c2d12;width:6%}    /* 2–5 */
.r2{background:#facc15;width:8%}    /* 6–13 */
.r3{background:#22c55e;width:10%}   /* 14–17 */
.r4{background:#fde047;width:7%}    /* 18–24 */
.r5{background:#dc2626;width:69%}   /* 25–60 */

.range-pointer{
  position:absolute;
  top:-8px;
  width:0;height:0;
  border-left:7px solid transparent;
  border-right:7px solid transparent;
  border-top:12px solid #000;
  transition:left .4s ease;
}
.range-labels{
  display:flex;
  justify-content:space-between;
  font-size:12px;
  margin-top:6px;
  color:#555;
}
</style>
</head>

<body>
<div class="container">

<div class="card">
<h1>Body Fat Calculator</h1>
<small>U.S. Navy Method · Medical-grade accuracy · US & Metric units</small>
<br><br>

<div class="grid">
  <select id="unit">
    <option value="metric">Metric (cm / kg)</option>
    <option value="us">US Units (in / lb)</option>
  </select>

  <select id="gender">
    <option value="">Gender</option>
    <option value="male">Male</option>
    <option value="female">Female</option>
  </select>

  <input id="age" type="number" placeholder="Age (18+)">
  <input id="height" type="number" placeholder="Height">
  <input id="weight" type="number" placeholder="Weight">
  <input id="neck" type="number" placeholder="Neck circumference">
  <input id="waist" type="number" placeholder="Waist circumference">
  <input id="hip" type="number" placeholder="Hip (female only)">
</div>

<br>
<button onclick="calculate()">Calculate</button>
<div id="error" class="error"></div>
</div>

<br>

<div class="grid">
  <div class="card"><div id="output">Result = —</div></div>

  <div class="card">
    <div class="chart-wrap">
      <canvas id="chart"></canvas>
      <div class="chart-center" id="centerText"></div>
    </div>

    <div class="range-wrap">
      <div class="range-bar">
        <div class="r1"></div><div class="r2"></div><div class="r3"></div>
        <div class="r4"></div><div class="r5"></div>
        <div class="range-pointer" id="pointer"></div>
      </div>
      <div class="range-labels">
        <span>Essential</span><span>Athletes</span><span>Fitness</span>
        <span>Average</span><span>Obese</span>
      </div>
    </div>
  </div>
</div>

</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
let chart;

gender.addEventListener("change",()=>{
  hip.disabled = gender.value === "male";
  if(gender.value === "male") hip.value="";
});

function pointerPos(bf){
  if(bf<=5) return (bf-2)/(5-2)*6;
  if(bf<=13) return 6+(bf-6)/(13-6)*8;
  if(bf<=17) return 14+(bf-14)/(17-14)*10;
  if(bf<=24) return 24+(bf-18)/(24-18)*7;
  return 31+(bf-25)/(60-25)*69;
}

function calculate(){
  error.innerText="";
  if(chart) chart.destroy();

  let unitVal=unit.value, g=gender.value;
  let agev=+age.value,h=+height.value,w=+weight.value;
  let n=+neck.value,wa=+waist.value,hi=+hip.value;

  if(!g||!agev||!h||!w||!n||!wa){
    error.innerText="Please fill all required fields.";
    return;
  }
  if(agev<18){
    error.innerText="This calculator is for adults (18+).";
    return;
  }

  if(unitVal==="us"){
    h*=2.54; w*=0.453592; n*=2.54; wa*=2.54; hi*=2.54;
  }

  if(g==="male" && wa<=n){
    error.innerText="For males, waist must be greater than neck.";
    return;
  }
  if(g==="female" && (!hi || wa+hi<=n)){
    error.innerText="For females, waist + hip must be greater than neck.";
    return;
  }

  let bf=g==="male"
    ?86.01*Math.log10(wa-n)-70.041*Math.log10(h)+36.76
    :163.205*Math.log10(wa+hi-n)-97.684*Math.log10(h)-78.387;

  bf=Math.min(Math.max(bf,2),60);

  let fat=w*(bf/100), lean=w-fat;
  let cat=bf<6?"Essential":bf<14?"Athletes":bf<18?"Fitness":bf<25?"Average":"Obese";

  let ideal=g==="male"
    ?Math.max(8,18-(agev-20)*0.2)
    :Math.max(18,25-(agev-20)*0.2);

  let lose=Math.max(0,w*(bf-ideal)/100);

  let bmi=w/((h/100)**2);
  let bmiBF=g==="male"?1.2*bmi+0.23*agev-16.2:1.2*bmi+0.23*agev-5.4;
  bmiBF=Math.min(Math.max(bmiBF,2),60);

  output.innerHTML=`
  <table>
    <tr><td><b>Body Fat</b></td><td>${bf.toFixed(1)}%</td></tr>
    <tr><td>Category</td><td>${cat}</td></tr>
    <tr><td>Fat Mass</td><td>${fat.toFixed(1)} kg</td></tr>
    <tr><td>Lean Mass</td><td>${lean.toFixed(1)} kg</td></tr>
    <tr><td>Ideal Body Fat</td><td>${ideal.toFixed(1)}%</td></tr>
    <tr><td>Fat to Lose</td><td>${lose.toFixed(1)} kg</td></tr>
    <tr><td>BMI Method (est.)</td><td>${bmiBF.toFixed(1)}%</td></tr>
  </table>`;

  centerText.innerHTML=`<b>${bf.toFixed(1)}%</b><span>${cat}</span>`;
  pointer.style.left=pointerPos(bf)+"%";

  chart=new Chart(chartEl,{
    type:"doughnut",
    data:{
      labels:["Fat Mass","Lean Mass"],
      datasets:[{
        data:[fat,lean],
        backgroundColor:["#f87171","#4ade80"]
      }]
    },
    options:{cutout:"70%",plugins:{legend:{position:"bottom"}}}
  });
}

const chartEl=document.getElementById("chart");
</script>
</body>
</html>
